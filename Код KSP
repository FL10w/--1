from json import dump 
from time import sleep 
import krpc 

a = krpc.connect(name='Vostok-1') 
lk = a.space_center.active_vessel 

data = [] 
start_time = a.space_center.ut 
stage = 0 
last_mass = lk.dry_mass 
srf_frame = lk.orbit.body.reference_frame 

lk.control.throttle = 1.0 
lk.control.sas = True 
lk.control.activate_next_stage() 

while a: 
    time_from_launch = a.space_center.ut - start_time 

    if stage == 3: 
        a = False 

    if last_mass - lk.dry_mass > 10: 
        last_mass = lk.dry_mass 
        stage += 1 

    data.append([time_from_launch, lk.flight(srf_frame).mean_altitude]) 
    print(lk.flight(srf_frame).mean_altitude, time_from_launch) 
    sleep(0.25) 

with open('flight_data.json', 'w') as f: 
    dump(data, f)
